## Semantic Color Mapper <sub><sup>顏色命名實驗<sup><sub>

> 你會如何形容這個顏色？

這是一個研究實驗，探索「顏色數值」與「語言描述」的關聯。\
透過蒐集使用者的命名數據，我們試圖回答一個問題：\
「在人類眼中，黃色是在哪裡變成了橘色？深藍色又是在哪裡變成了黑色？」



👉 [查看網頁 Color Mapper](https://color-mapper.vercel.app/)

<br>

<img width="896" height="730" alt="image" src="https://github.com/user-attachments/assets/3535f726-0dd0-472f-ae52-7e9e7aa941b1" />

<br>

<br>

**核心功能（Features）**

- **😎 色彩測驗**\
  系統會在 OKLch 色彩空間中隨機生成顏色，讓使用者進行命名
- **🤖 智慧審核**\
  整合 Gemini，分析回答並給予回饋，增加答題意願
  - 自動過濾亂碼與無意義詞彙
  - 識別具創意的命名並給予幽默回饋
  - 防止明顯的視覺矛盾（如：把紅色說成綠色）
- **👀 數據呈現**\
  使用 D3.js 繪製色彩分布圖，即時顯示眾人對特定色相的定義範圍
- **☁️ 雲端同步**\
  結合 Firebase，所有數據即時上傳並同步給所有用戶
- **🌙 深淺模式**\
  支援深色/淺色模式切換，專注於色彩體驗的 UI 設計

<br>

**技術棧（Tech Stack）**

- **Frontend**: React, TypeScript, Vite
- **Styling**: Tailwind CSS, clsx
- **Visualization**: D3.js (d3-delaunay)
- **AI Integration**: Google Generative AI SDK (gemini-2.5-flash-lite)
- **Backend / Database**: Firebase Realtime Database
- **Deployment**: Vercel

<br>

## 更新記錄（Changelog）

- `2025/01/07（三）` **💬輸入框UI大改**
  -  原本的輸入框跟按鈕盤踞在不同地方，有的還沒有底色顯得很碎片
    - 圓角變圓、變大、更現代，根據情況顯示對應按鈕，減少空間浪費
  <br>
  <img width="672" height="357" alt="image" src="https://github.com/user-attachments/assets/750051df-f3cf-43ea-8040-82ce72674ecd" />
  <br>
- `2025/01/06（二）` **🤖收斂太嗆的口氣**
  - 原本 AI 回饋有趣是有趣，但因為判別而拒絕收錄回答時，口氣太兇、太嗆，會導致心情不好
    - 重新教育講話要溫柔一點，不要像個網路酸民了
  - 新增查看 Hex 色碼的按鈕 (像`#FFFFFF`這種) 
    - 順便驗證給 AI 的色碼有沒有正確

- `2025/01/05（一）` **📈圖表微微放大**
  - 原本圖表太小看不太清楚，放大了一些

- `2025/12/31（三）` **🤖回饋更人性**
  - 既幽默也寬容：重寫了 prompt，嘗試讓回答判斷交給AI，而不是我一直列出數學規範。不像舊版的回答很制式（只會從那幾個選項挑），新版的回饋變得很像人
  - 追加色碼小抄：原先給 AI 顏色數值是OKLch，但OKLch有點新穎，怕 AI 參考資料不夠多，追加轉換 Hex 小抄，幫助判斷更正確

- `2025/12/30（二）` **🧶思維鏈調整**
  - Schema 優化：先思考`reason`、`feedback`，再決定要不要收錄該回答`isSuspicious`
  - 喬了一下圖表讓他數學上偏左，這樣正方形圖表視覺上才會剛好置中
  - 圖表 hover 時，變粗的線框現在會正確的壓在最上面

- `2025/12/29（一）` **🧹程式碼微更新**
  - `package.json`安裝的套件版本都改至最新（原本寫的版本都太舊）
  - 舊版 @google/generative-ai (我現在用的) 是目前最穩定版本，不會部署失敗
    - 2026的我要記得換成新版的 @google/genai（但現在還不行換，會失敗）

- `2025/12/26（五）` **🤖邏輯更新**
  - 提升語意理解力：加強對品牌色、特殊形容詞以及文化梗的辨識能力，減少誤判
  - 放寬色彩邊界判定：針對「青色（藍綠）」、「洋紅（紫紅）」、「靛色（藍紫）」等模糊地帶，不再嚴格區分，容許更廣泛的定義
    - 如：把青色說成綠色或藍色皆可
  - 優化回饋語氣：新增「教育型」與「通用型」點評風格
    - 當答案介於兩者之間時（例如偏橘的黃），AI 會給予更人性化、具引導性的回覆，而非直接拒絕

- `2025/12/24（三）` **📦抽樣優化**
  - 拒絕鬼打牆：優化了隨機出題邏輯，現在下一題絕對不會出現跟上一題「相同」或「相鄰」的色系，讓題目變化更豐富
    - 如：黃色考完，下題就不會出現鄰居「金（85°）、黃（105°）、檸（125°）」
  - 顏色分布更自然：改良了色彩生成演算法（採用投點法），現在能更均勻地骰出各種漂亮的顏色
    - 解決了題目容易卡在「極限邊緣」或一直出現「髒髒深色」的問題
  - 調整網站名稱為 Color Mapper
  - 新增網頁小圖示（我的頭貼）
  - 網頁底部放上GitHub、YouTube、Portfolio

- `2025/12/23（二）` **🛼操作更絲滑**
  - 讓前綴按鈕變成一排，過長可左右滑動，而非過長換行（wrap）
    - 目的為減少空間浪費，避免鍵盤升起時都看不到題目顏色
  - 手機版升起鍵盤後，讓「輸入框與送出鈕」正確在剩餘畫面露出，不被鍵盤遮擋
  - 解決了升起鍵盤後，捲動畫面不順暢的問題
    - 手機瀏覽器有太多種意外，真的要瘋掉
    - 作法：
      - 初次點擊時，要抓視窗的高度變化兩次
        - 第一次是中斷安卓預設捲動規則（預設捲太高了），且安卓反應真的慢半拍需要第二次抓定位（iOS第一次就會開始捲動）
        - 第二次是重新抓定位（時間也不能太早，要大於iOS鍵盤升起來的時間，才不會讓iOS有破綻看到「捲停捲停」兩次）
      - 再次點擊時，因瀏覽器已經得知了鍵盤升起後的剩餘高度，就不用再抓視窗的高度變化兩次了，改為一次就好
        - 但時間也不能太即時，因為安卓會慢半拍

- `2025/12/22（一）` **🎯答題更直覺**
  - 發現使用者點了前綴詞選項就想送出，沒有繼續加上後綴（紅、橘、藍...等等），導致最終只送出「霧」、「明」這種意義不明的字
  - 刪除題目下面小字「目前色相：XX色」的提示
    - 因為如果留著，使用者會覺得只要選前綴詞就好
  - 輸入內容「完全等於」某個前綴字時，會跳出提示toast阻擋，來防止只送出「霧」、「明」這種意義不明的前綴字
    - 如果使用者在這情況下堅持點擊送出時，會跳出提示toast說後面是不是可以加個什麼顏色名
    - 有些例外前綴是可以直接傳出去的，如「白、灰、黑」，因為有些很灰的顏色，就只會說那是「灰」，而不一定追加顏色後綴寫出「灰藍」
  - 點擊「前綴詞」後，強制將游標聚焦回輸入框，暗示使用者需繼續輸入
    - 輸入框會有提示字，暗示使用者需接著前綴詞繼續輸入（如：選擇「淺」，則會顯示「淺什麼色？」）
    - 手機版會自動跳起鍵盤，方便接續輸入

- `2025/12/19（五）` **✂️修整圖表**
  - 圖表虛線（極限飽和度）線條會有不順的凸起（於低亮度處），於是人工割除，變成漂亮乾淨的三角形

- `2025/12/18（四）` **🌏成功發布**
  - 真的串接了後台（Firebase），可以世界各地的人共享資料了
  - 真的串接了AI（Gemini），可以幫忙判定回答有沒有效了
  - 有了網頁真開心

- `2025/12/12（五）` **🤖標準細調**
  - AI 審核放寬，儘管是屎尿屁的命名，如果合理也是會收錄的
  - 但如果只是在亂輸入一些廢話還是會被擋下來

- `2025/12/11（四）` **✨答題回饋**
  - 答題後，會有AI點評回饋（於右下角 toast 板子彈出），增加作答後的回饋感
  - 答太爛是會被婉拒收錄的

- `2025/12/09（二）` **📄儲存資料**
  - 將答題過的資料，儲存在網頁的 localStorage，同一人可以看到自己先前答題過的記錄（先前頁面重整資料就不見）
  - 此時還沒能讓世界各地的人共享資料

- `2025/12/05（五）` **🤖放寬標準**
  - AI（Gemini）判定太嚴苛，導致有些有趣的名字會不收錄
  - 但會防止「紅色故意說綠色」、「白色說黑色」等這種一看就不合理的答案

- `2025/12/04（四）` **⭐️開始製作**
  - 透過 Google AI Studio 的 Build 製作顏色語感表，想透過共識決議，做成網頁集結大家力量完成顏色的命名
  - 製作了隨機生成顏色的題目，詢問使用者這是什麼顏色，會有AI（Gemini）判定是否收錄回答
  - 提供了前綴詞選項，提點使用者可以如何更精確描述
  - 製作了 voronoi 分布圖表，利用空間分割算法，得知大眾會如何稱呼那些特定區域的顏色
  - 此時網頁還沒對外開放
